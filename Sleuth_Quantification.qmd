---
title: "Sleuth and Kallisto"
author: "Roberto √Ålvarez"
#format: revealjs
editor: visual
format:
  html:
    toc: true
    toc_float: true
---


##  Sleuth from Kallisto

This tutorial will take you through a sample RNA-Seq analysis using [kallisto](https://pachterlab.github.io/kallisto/about), using an RNA-Seq R package [Sleuth](https://pachterlab.github.io/sleuth/about). This tutorial is based on the one by the [Pachter lab](https://pachterlab.github.io/sleuth_walkthroughs/boj/analysis.html)

## Paso 1: Cargar Sleuth y bibliotecas adicionales



```{r}
#| echo: true
library(sleuth)
library("gridExtra")
library("cowplot")
```


## BiomaRt


We will also use [biomaRt](https://bioconductor.org/packages/release/bioc/html/biomaRt.html) tools will allow us to pull in recognizable gene names from a database.


```{r echo=FALSE, message=FALSE, warning=FALSE}
#| echo: true
library("biomaRt")
```



## Paso 2:  Load experimental design and label kallisto outputs with metadata

### Locate sample names and describe our experimental design

We need to provide Sleuth with our sample names:

```{r}
#| echo: true
sample_id <- dir(file.path("01_Raw_Data/kallisto_quant_output/"))
sample_id
```


## Resultados

We also need to get the file paths to our results files.
```{r}
#| echo: true
kal_dirs <- file.path("01_Raw_Data/kallisto_quant_output/", sample_id)
```

## Nombre descriptivos

We also need a table that provides more meaningful names for describing our experiment...

```{r}
s2c <- read.table(file.path("01_Raw_Data/kallisto_demo.tsv"),
                  header = TRUE,
                  stringsAsFactors = FALSE,
                  sep = "\t")
s2c
```

## Tabla
We will add our file paths to the table

```{r}
s2c <- dplyr::mutate(s2c, path = kal_dirs)
```

Let's view the table we have created:
```{r}
s2c
```

## Tabla bonita

Let's view the table we have created:
```{r}
library(DT)
DT::datatable(s2c)
```


## Step 3: Load gene names from Ensembl

Next we need to determine which biomaRt to use. This can be a little complex so be sure to read their [documentation](https://www.bioconductor.org/packages/devel/bioc/vignettes/biomaRt/inst/doc/biomaRt.html). This [blog post](https://nsaunders.wordpress.com/2015/04/28/some-basics-of-biomart/) is also helpful.

```{r}
marts <- listMarts()
marts
```

## Step 3: Load gene names from Ensembl

If you are not working with these Ensembl data bases you may want to check out documentation on [using BiomaRts other than Ensembl](https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/biomaRt.html#using-a-biomart-other-than-ensembl). We are using plants, so...

```{r}
marts <- listMarts(host = "plants.ensembl.org")
marts
```


## Step 3: Load gene names from Ensembl
For now, remember that we will want to use `plants_mart`.

Next, we need to choose a specific data set.

```{r}
plants_mart <- useMart("plants_mart", host = "plants.ensembl.org" )
datatable(listDatasets(plants_mart))

```

## Seleccionamos Arabidopsis thaliana

After a little looking, its the `athaliana_eg_gene` data set that we need. Finally, we need to update our `plants_mart` to be more specific.

```{r}
#| echo: true
plants_mart <- useMart("plants_mart", dataset = "athaliana_eg_gene", host="plants.ensembl.org" )
```

Now we want to get specific attributes from the list of genes we can import from biomart

```{r}
listAttributes(plants_mart)
```


## Seleccionamos Arabidopsis thaliana



Now we want to get specific attributes from the list of genes we can import from biomart

```{r}
datatable(listAttributes(plants_mart))
```




## Quarto

Quarto enables you to weave together content and executable code into a finished presentation. To learn more about Quarto presentations see <https://quarto.org/docs/presentations/>.

## Bullets

When you click the **Render** button a document will be generated that includes:

-   Content authored with markdown
-   Output from executable code

## Code

When you click the **Render** button a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```
